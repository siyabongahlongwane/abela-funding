<div class="horizontal-center-stretch full-width full-height">
    <mat-card class="full-width full-height">
        <div class="vertical-start-stretch stepper-container">
            <mat-stepper [linear]="" #stepper>
                <mat-step [stepControl]="personalDetails">
                    <form [formGroup]="personalDetails">
                        <ng-template matStepLabel>Personal Details</ng-template>
                        <div class="vertical-center-center gap-1em">
                            <div class="horizontal-start-stretch width-90">
                                <h1 class="bold">Your Details</h1>
                            </div>
                            <div class="horizontal-space-between-stretch width-90">
                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Name</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
                                            matInput formControlName="name" placeholder="Name">
                                        <mat-error *ngIf="personalDetails.get('name')?.hasError('required')">
                                            Name is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Surname</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
                                            matInput formControlName="surname" placeholder="Surname">
                                        <mat-error *ngIf="personalDetails.get('surname')?.hasError('required')">
                                            Surname is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30 date-picker">
                                    <label class="bold">Date of Birth</label>
                                    <mat-form-field appearance="outline">
                                        <input (click)="picker.open()" matInput [matDatepicker]="picker"
                                            formControlName="dateOfBirth" placeholder="Date of Birth">
                                        <mat-icon (click)="picker.open()" matSuffix>event_note</mat-icon>
                                        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-datepicker #picker></mat-datepicker>
                                        <mat-error *ngIf="personalDetails.get('dateOfBirth')?.hasError('required')">
                                            Date of Birth is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="horizontal-space-between-end width-90">
                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">School Currently Attending</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
                                            matInput formControlName="schoolCurrentlyAttending"
                                            placeholder="School Currently Attending">
                                        <mat-error
                                            *ngIf="personalDetails.get('schoolCurrentlyAttending')?.hasError('required')">
                                            School Currently Attending is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">School You Wish To Attend</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
                                            matInput formControlName="schoolWishToAttend"
                                            placeholder="School You Wish To Attend">
                                        <mat-error
                                            *ngIf="personalDetails.get('schoolWishToAttend')?.hasError('required')">
                                            School You Wish To Attend is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Grade and Year</label>
                                    <mat-form-field appearance="outline">
                                        <input matInput formControlName="gradeAndYearDoing"
                                            placeholder="e.g. Doing Grade 7 in 2023">
                                        <mat-error
                                            *ngIf="personalDetails.get('gradeAndYearDoing')?.hasError('required')">
                                            Grade and Year <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="horizontal-start-end margin-top-1em">
                                <button [disabled]="personalDetails.invalid" class="primary-bg white-color round" mat-raised-button
                                    matStepperNext>Next</button>
                            </div>
                        </div>
                    </form>
                </mat-step>
                <mat-step [stepControl]="addressDetails">
                    <form [formGroup]="addressDetails">
                        <ng-template matStepLabel>Address</ng-template>
                        <div class="vertical-center-center gap-1em">
                            <div class="horizontal-start-stretch width-90">
                                <h1 class="bold">Address Details</h1>
                            </div>
                            <div class="horizontal-space-between-stretch width-90">
                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Town</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
                                            matInput formControlName="town" placeholder="Town">
                                        <mat-error *ngIf="addressDetails.get('town')?.hasError('required')">
                                            Town is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">City</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
                                            matInput formControlName="city" placeholder="City">
                                        <mat-error *ngIf="addressDetails.get('city')?.hasError('required')">
                                            City is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Province</label>
                                    <mat-form-field appearance="outline" [floatLabel]="'never'">
                                        <mat-select formControlName="province" placeholder="Province">
                                            <mat-option *ngFor="let province of provinces" [value]="province">{{
                                                province }}</mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="addressDetails.get('province')?.hasError('required')">
                                            Province is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="horizontal-start-stretch width-90">
                                <h1 class="bold">Contact Details</h1>
                            </div>
                            <div class="horizontal-space-between-stretch width-90">
                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Cell Number 1</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[A-Z a-z]/g, '')"
                                            matInput formControlName="cellOne" placeholder="Cell Number 1">
                                        <mat-error *ngIf="addressDetails.get('cellOne')?.hasError('required')">
                                            Cell Number 1 is <b>required!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Cell Number 2</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" oninput="this.value = this.value.replace(/[A-Z a-z]/g, '')"
                                            matInput formControlName="cellTwo" placeholder="Cell Number 2">
                                    </mat-form-field>
                                </div>

                                <div class="vertical-start-stretch grey-input-container width-30">
                                    <label class="bold">Email</label>
                                    <mat-form-field appearance="outline">
                                        <input type="text" matInput formControlName="email" placeholder="Email">
                                        <mat-error
                                            *ngIf="addressDetails.get('email')?.hasError('required') && !addressDetails.get('email')?.hasError('pattern')">
                                            Email is <b>required!</b>
                                        </mat-error>
                                        <mat-error *ngIf="addressDetails.get('email')?.hasError('pattern')">
                                            Email is <b>invalid!</b>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="oprizontal-start-end margin-top-1em">
                                <button [disabled]="addressDetails.invalid" class="primary-bg white-color round" mat-raised-button
                                    matStepperNext>Next</button>
                            </div>
                        </div>
                    </form>
                </mat-step>
                <mat-step [stepControl]="applicationForm">
                    <form [formGroup]="applicationForm">
                        <ng-template matStepLabel>Subjects</ng-template>
                        <div class="vertical-center-center gap-2em width-90">
                            <div class="horizontal-start-stretch width-90">
                                <h1 class="bold">Subjects & Marks</h1>
                            </div>
                            <div class="horizontal-start-stretch gap-1em">
                                <mat-radio-button value="upload" (click)="toggleState(true)">Upload Marks
                                    Document</mat-radio-button>
                                <mat-radio-button value="insert" (click)="toggleState(false)">Insert Marks
                                    Manually</mat-radio-button>
                            </div>
                            <div *ngIf="isUpload == false" class="vertical-center-stretch width-90 gap-1em">
                                <div *ngFor="let subject of subjects.controls; let i = index" formArrayName="subjects"
                                    class="horizontal-space-between-center">
                                    <div class="vertical-start-stretch grey-input-container width-25"
                                        [formGroupName]="i">
                                        <label class="bold">Subject {{ i + 1}}</label>
                                        <mat-form-field appearance="outline">
                                            <input type="text" matInput
                                                formControlName="subject" placeholder="Subject {{ i + 1}}">
                                                <mat-error *ngIf="applicationForm.get('subject')?.hasError('required')">
                                                    Subject {{i}} is <b>required!</b>
                                                </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="vertical-start-stretch grey-input-container width-25"
                                        [formGroupName]="i">
                                        <label class="bold">Standard {{ i + 1 }}</label>
                                        <mat-form-field appearance="outline" [floatLabel]="'never'">
                                            <mat-select formControlName="standard" placeholder="Standard {{i + 1}}">
                                                <mat-option *ngFor="let standard of standards" [value]="standard">{{
                                                    standard }}</mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="applicationForm.get('standard')?.hasError('required')">
                                                Standard {{i}} is <b>required!</b>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="vertical-start-stretch grey-input-container width-25"
                                        [formGroupName]="i">
                                        <label class="bold">Mark {{ i + 1 }}</label>
                                        <mat-form-field appearance="outline">
                                            <input type="text"
                                                oninput="this.value = this.value.replace(/[A-Z a-z]/g, '')" matInput
                                                formControlName="mark" placeholder="Mark {{i + 1}}">
                                                <mat-error *ngIf="applicationForm.get('mark')?.hasError('required')">
                                                    Mark {{i}} is <b>required!</b>
                                                </mat-error>
                                                <mat-error *ngIf="applicationForm.get('mark')?.hasError('max')">
                                                    Mark cannot be more than <b>100%</b>
                                                </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="horizontal-start-stretch gap-1em margin-top-1-5em">
                                        <button (click)="addSubject()" class="primary-bg white-color round height-3em"
                                            mat-raised-button><mat-icon>add</mat-icon></button>
                                        <button *ngIf="subjects.length > 1" color="warn" (click)="removeSubject(i)"
                                            class="round height-3em"
                                            mat-raised-button><mat-icon>remove</mat-icon></button>
                                    </div>
                                </div>
                                <div class="vertical-start-center">
                                    <button (click)="onSubmit()" class="primary-bg white-color round"
                                        mat-raised-button >Submit</button>
                                </div>
                            </div>
                            <div *ngIf="isUpload" class="vertical-start-stretch gap-1em">
                                <button (click)="onSubmit()" class="primary-bg white-color round" mat-raised-button
                                    >
                                    <div class="horizontal-start-center gap-1em">
                                        Upload Marks<mat-icon>cloud</mat-icon>
                                    </div>
                                </button>
                                <button (click)="onSubmit()" class="secondary-bg white-color round" mat-raised-button
                                    matStepperNext>Submit</button>
                            </div>
                        </div>
                    </form>
                </mat-step>
            </mat-stepper>
        </div>
    </mat-card>
</div>